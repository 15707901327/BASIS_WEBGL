<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GLSL ES</title>
  <link rel="stylesheet" href="../../css/base.css">
  <link rel="stylesheet" href="../css/base.css">
</head>
<body>
<div class="header">
  <ul>
    <li><a href="../../index.html">首页</a></li>
    <li><a href="../webgl/index.html">webgl概述</a></li>
    <li><a href="../opengl/index.html">OpenGL概述</a></li>
    <li><a href="../graphics/index.html">图形学</a></li>
    <li class="li_heightLight"><a href="../shader/index.html">GLSL ES</a></li>
    <li><a href="../webgl/js_API/gl.html">WebGL API</a></li>
    <li><a href="../../example/index.html" target="_parent">WebGL实例</a></li>
  </ul>
</div>
<div class="content">
  <div class="l-r-wrapper">
    <div class="left">
      <h4><a href="#shader">着色器概述</a></h4>
      <h4><a href="#grammar">着色器语法</a></h4>
      <ul class="ul-1">
        <li><a href="#annotate">注释说明</a></li>
        <li><a href="#codingStandards">编码规范</a></li>
        <li><a href="#baseDataType">基本数据类型</a></li>
        <li><a href="#polymericType">聚合数据类型</a></li>
        <li><a href="#struct">结构体</a></li>
        <li><a href="#array">数组</a></li>
        <li><a href="BuiltInFunction.html" target="_blank">内置函数</a></li>
        <li><a href="customFunction.html" target="_blank">Custom Function</a></li>
        <li><a href="#preprocessingInstruction">预处理指令</a></li>
      </ul>
      <h4><a href="#storageQualifier">存储限定符</a></h4>
      <ul class="ul-1">
        <li><a href="#const">const</a></li>
        <li><a href="#attribute">attribute</a></li>
        <li><a href="#uniform">uniform</a></li>
        <li><a href="#varying">varying</a></li>
        <li><a href="#difference">限定符区别</a></li>
      </ul>
      <h4><a href="#precisionQualifier">精度限定符</a></h4>
      <h4><a href="#parameterQualifier">参数限定符</a></h4>
      <h4><a href="#">着色器技术</a></h4>
      <ul class="ul-1">
        <li><a href="BRDF.html" target="_blank">BRDF*基于物理的着色器技术</a></li>
        <li><a href="dFdxy.html">偏导数dFdx和dFdy介绍</a></li>
      </ul>
      <h4><a href="#variable">着色器中的变量</a></h4>
      <ul class="ul-1">
        <li><a href="#fragmentBuiltVariable">片元着色器中的内置变量</a></li>
        <li><a href="#vertexBuiltVariable">顶点着色器中的内置变量</a></li>
      </ul>
      <h4><a href="#dataType">数据类型</a></h4>
      <ul class="ul-1">
        <li><a href="#numberType">数据值类型</a></li>
        <li><a href="#texture">专用于纹理的数据类型</a></li>
      </ul>
    </div>
    <div class="right">
      <section id="shader" class="section1">
        <h4 class="title">着色器</h4>
        <section>
          <strong>定义：</strong>
          <p>图形硬件所执行的一类特殊的函数，可以理解为专门为图形处理单元（GPU）编译的一种小型程序。</p>
          <strong>GLSL ES：</strong>
          <p>GLSL ES编程语言是在OpenGL着色器语言（GLSL）的基础上，删除和简化一部分功能后形成的。是专门用来编写着色器的编
            程语言。</p>
          <div class="content">
            <strong>GLSL ES版本:</strong>
            <table border="1">
              <tr>
                <th>OpenGL ES 版本</th>
                <th>GLSL ES 版本</th>
              </tr>
              <tr>
                <th>2.0</th>
                <th>100</th>
              </tr>
              <tr>
                <th>3.0</th>
                <th>300</th>
              </tr>
            </table>
          </div>
        </section>
      </section>
      <section id="grammar" class="section1">
        <h4 class="title">着色器语法</h4>
        <section id="annotate">
          <h4>注释说明</h4>
          <div class="content">
            <ul class="ul-1">
              <li>单行注释 //</li>
              <li>多行注释 /**/</li>
            </ul>
          </div>
        </section>
        <section id="codingStandards">
          <h4>编码规范</h4>
          <div class="content">
            <ul class="ul-1">
              <li>程序是大小写敏感的</li>
              <li>每个语句都应该以一个英文分号(;)结束</li>
            </ul>
          </div>
        </section>
        <section id="baseDataType">
          <h4>基本数据类型</h4>
          <div class="content">
            <table border="1" style="border-collapse: collapse">
              <tr>
                <th>类型</th>
                <th>描述</th>
              </tr>
              <tr>
                <td>float</td>
                <td>单精度浮点数</td>
              </tr>
              <tr>
                <td>double</td>
                <td>双精度浮点数</td>
              </tr>
              <tr>
                <td>int</td>
                <td>有符号32位整型数</td>
              </tr>
              <tr>
                <td>uint</td>
                <td>无符号32位整型数</td>
              </tr>
              <tr>
                <td>bool</td>
                <td>布尔值</td>
              </tr>
            </table>
            <p>不同类型之间的变量赋值，需要使用<a href="BuiltInFunction.html#typeConversion" target="_blank">类型转换函数</a>进行类型转换</p>
          </div>
        </section>
        <section id="polymericType">
          <h4>聚合数据类型</h4>
          <div class="content">
            <table border="1">
              <tr>
                <th colspan="3">矢量和矩阵类型</th>
              </tr>
              <tr>
                <th>类别</th>
                <th>数据类型</th>
                <th>描述</th>
              </tr>
              <tr>
                <td>矢量</td>
                <td>
                  <p>vec2、vec3、vec4</p>
                  <p>ivec2、ivec3、ivec4</p>
                  <p>bvec2、bvec3、bvec4</p>
                </td>
                <td>
                  <p>具有2、3、4个浮点数元素的矢量</p>
                  <p>具有2、3、4个整形数元素的矢量</p>
                  <p>具有2、3、4个布尔值元素的矢量</p>
                </td>
              </tr>
              <tr>
                <td>矩阵</td>
                <td>mat2、mat3、mat4</td>
                <td>
                  2*2、3*3、4*4的浮点元素的矩阵
                </td>
              </tr>
            </table>
          </div>
        </section>
        <section id="struct">
          <h4>结构体：</h4>
          <div class="content">
          </div>
        </section>
        <section id="array">
          <h4>数组：</h4>
          <p>GLSL ES只支持一维数组,而且数组对象不支持pop()和push()等操作，创建数组也不需要使用new运算符。</p>
          <div class="content">
            <strong>创建数组：</strong>
            <p>在变量名后面加上中括号[]和数组长度。</p>
            <p>float floatArray[4]; // 声明含有4个浮点数元素的数组</p>
            <p>数组的长度必须是大于0的 整型常量表达式 </p>
            <ul class="ul-2-num">
              <li>整型字面量（如0或1）</li>
              <li>用const限定字修饰的全局变量或局部变量，不包含函数参数。</li>
            </ul>
            <strong>引用数组：</strong>
            <p>数组可以通过引用值来访问。</p>
            <p>只有整型常量表达式和uniform变量可以被用作数组的索引。</p>
            <strong>注意：</strong>
            <ul class="ul-2-num">
              <li>不可以用const限定字来修饰数组本身。</li>
            </ul>
          </div>
        </section>
        <section id="preprocessingInstruction">
          <h4>预处理指令：</h4>
          <div class="content">
            <h4>if表达式</h4>
            <p>#if 条件表达式</p>
            <p>如果条件表达式为真、执行这里</p>
            <p>#endif</p>

            <strong>ifdef表达式</strong>
            <p>#ifdef 某宏</p>
            <p>如果定义了某宏、执行这里</p>
            <p>#endif</p>

            <h4>ifndef表达式</h4>
            <p>#ifndef 某宏</p>
            <p>如果没有定义某宏、执行这里</p>
            <p>#endif</p>

            <h4>#if defined(某宏)</h4>
            <p>#if defined(某宏)</p>
            <p>如果定义某宏、执行这里</p>
            <p>#endif</p>
          </div>
        </section>
      </section>
      <section id="storageQualifier" class="section1">
        <h4 class="title">存储限定符</h4>
        <section id="const">
          <h4>const 变量</h4>
          <div class="content">
            <p>声明常量</p>
            <strong>声明变量</strong>
            <p>变量的声明格式：存储限定符->类型->变量名</p>
            <p>const vec4 red = vec4(1.0, 0.0, 0.0 1.0);</p>
          </div>
        </section>
        <section id="attribute">
          <h4>attribute</h4>
          <div class="content">
            <strong>声明变量</strong>
            <p>关键词attribute被称为存储限定符,它表示接下来的变量是一个attribute变量，被用来从外部向顶点着色器内传输数据，被用来表示逐顶点的信息。</p>
            <p>变量的声明格式：存储限定符->类型->变量名</p>
            <p>attribute vec4 a_Position;</p>
            <strong>说明:</strong>
            <ul class="ul-1-num">
              <li>只能出现在顶点着色器中。</li>
              <li>只能被声明为全局变量。</li>
              <li>只能指定float类型的attribute变量。</li>
            </ul>
            <strong>实例一：在顶点着色器中声明变量，并使用</strong>
            <pre>
        // 顶点着色器程序
        var VSHADER_SOURCE =
          'attribute vec4 a_Position;\n' +
          'void main() {\n' +
          '  gl_Position = a_Position;\n' + //设置坐标
          '  gl_PointSize = 10.0;\n' + //设置尺寸
          '}\n';
    </pre>
          </div>
        </section>
        <section id="uniform">
          <h4>uniform</h4>
          <p>uniform 是 GLSL 中的一种变量类型限定符，用于存储应用程序通过GLSL传递给着色器的只读值。uniform 可以用来存储着
            色器需要的各种数据，如变换矩阵、光参数和颜色等。传递给着色器的在所有的顶点着色器和片元着色器中保持不变的的任何参数，基本上都应该通过 uniform 来存储。uniform 变量在全局区声明,</p>
          <div class="content">
            <strong>声明变量</strong>
            <p>变量的声明格式：存储限定符->类型->变量名</p>
            <p>uniform vec4 u_FragColor</p>
            <strong>注意：</strong>
            <ul class="ul-1-num">
              <li>uniform 变量可以用在顶点着色器和片元着色器中，且必须是全局变量。</li>
              <li>uniform 变量是只读的，它可以是除了数组或结构体之外的任意类型。</li>
              <li>uniform 变量传输的是那些对于所有顶点都相同（或与顶点无关的数据）</li>
              <li>顶点着色器和片元着色器共享了 uniform 变量的命名空间。对于连接于同一个着色程序对象的顶点和片元着色器，它们共用同一组 uniform 变量，因此，如果在顶点着色器和片元着色器中都声明了
                uniform
                变量，二者的声明必须一致。当应用程序通过 API 加载了 uniform 变量时，该变量的值在顶点和片元着色器中都能够获取到。
              </li>
              <li>uniform 变量通常是存储在硬件中的”常量区”，这一区域是专门分配用来存储常量的，但是由于这一区域尺寸非常有限，因此着色程序中可以使用的 uniform 的个数也是有限的。</li>
            </ul>
            <strong>实例一：在片元着色器中声明变量并使用</strong>
            <pre>
        // 片元着色器
        var FSHADER_SOURCE =
        'uniform vec4 u_FragColor;\n' +
        'void main() {\n' +
        '  gl_FragColor = u_FragColor;\n' +
        '}\n';
    </pre>
            <strong>实例</strong>
            <ul>
              <li><a href="../../../WebGL编程指南/ch2/ClickedPoints.html">点击画点</a></li>
            </ul>
          </div>
        </section>
        <section id="varying">
          <h4>varying 变量</h4>
          <div class="content">
            <strong>声明</strong>
            <p>varying
              变量的任务是从顶点着色器向片元着色器传输数据，我们必须在两种着色器中声明同名，同类型的变量。顶点着色器中赋给varying变量的值并不是直接传递给了片元着色器的varying变量，这其中发生了<a
                  href="../WebGL程序.html#section_4">光栅化</a>的过程。</p>
            <p>变量的声明格式：存储限定符->类型->变量名</p>
            <p>varying vec4 v_Color</p>
            <strong>说明</strong>
            <ul>
              <li>varying 变量必须是全局变量</li>
            </ul>
          </div>
        </section>
        <section id="difference">
          <h4>uniform、varying、attribute区别</h4>
          <div class="content">
            <p>uniform 表示一次渲染过程中保存不变的，GPU的工作模式是多管道的，相当于一个像素点对应着一个管道，
              当然并不是说有这么多管道，只是表示他是一一对应并且一起处理；那么把整个屏幕处理时uniform是持不变的</p>
            <p>attribute 表示是实时在改变的，比如通常我们用了存放顶点，和颜色</p>
            <p>varying 用来着色器之间的通讯,也就是顶点着色器和片元着色去之间的桥梁；比如你要传一个顶点颜色，你需要在两个着色
              器里声明一个变量，然后你把颜色传入到顶点着色器中，并在main()函数里赋值，这才能把赋值给你声明的varying vec4 color</p>
          </div>
        </section>
      </section>
      <section id="precisionQualifier" class="section1">
        <h4 class="title">精度限定符</h4>
        <section id="precision">
          <h4>精度限定词</h4>
          <div class="content">
            <p>精度限定词用来指定变量的范围（最大值和最小值）和精度。</p>
            <strong>默认值</strong>
            <div>
              <p>#ifdef GL_ES</p>
              <p>precision mediump float</p>
              <p>#endif</p>
            </div>
            <strong>精度限定字</strong>
            <table border="1">
              <tr>
                <th colspan="4">精度限定字</th>
              </tr>
              <tr>
                <th>精度限定字</th>
                <th>描述</th>
                <th colspan="2">默认数值范围和精度</th>
              </tr>
              <tr>
                <td colspan="2"></td>
                <td>Float</td>
                <td>int</td>
              </tr>
              <tr>
                <td>highp</td>
                <td>高精度，顶点着色器的最低精度</td>
                <td>（-2^62,2^26）精度2^-16</td>
                <td>(-2^16,2^16)</td>
              </tr>
              <tr>
                <td>mediump</td>
                <td>中精度，介于高精度与低精度之间，片元着色器的最低精度</td>
                <td>（-2^14,2^14）精度2^-10</td>
                <td>(-2^10,2^10)</td>
              </tr>
              <tr>
                <td>lowp</td>
                <td>低精度，低于中精度，可以表示所有颜色</td>
                <td>（-2,2）精度2^8</td>
                <td>(-2^8,2^8)</td>
              </tr>
            </table>
            <p>在某些Webgl环境中，片元着色器可能不支持highp精度</p>
            <strong>数据类型的默认精度</strong>
            <table border="1">
              <tr>
                <th colspan="3">数据类型的默认精度</th>
              </tr>
              <tr>
                <td rowspan="4">顶点着色器</td>
                <td>int</td>
                <td>highp</td>
              </tr>
              <tr>
                <td>float</td>
                <td>highp</td>
              </tr>
              <tr>
                <td>sampler2D</td>
                <td>lowp</td>
              </tr>
              <tr>
                <td>samplerCube</td>
                <td>lowp</td>
              </tr>
              <tr>
                <td rowspan="4">片元着色器</td>
                <td>int</td>
                <td>mediump</td>
              </tr>
              <tr>
                <td>float</td>
                <td>无</td>
              </tr>
              <tr>
                <td>sampler2D</td>
                <td>lowp</td>
              </tr>
              <tr>
                <td>samplerCube</td>
                <td>lowp</td>
              </tr>
            </table>
            <strong>实例一：使用精度限定词限定中等精度</strong>
            <pre>
// 顶点着色器程序
var VSHADER_SOURCE =
  'precision mediump float;\n' + // 声明默认精度
  'attribute vec4 a_Position;\n' +
  'void main() {\n' +
  '  gl_Position = a_Position;\n' + //设置坐标
  '  gl_PointSize = 10.0;\n' + //设置尺寸
  '}\n';
</pre>
          </div>
        </section>
      </section>
      <section id="parameterQualifier" class="section1">
        <h4 class="title">参数限定符</h4>
        <p>GLSL 提供了一种特殊的限定符用来定义某个变量的值是否可以被函数修改.</p>
        <section>
          <table border="1">
            <tr>
              <th>限定符</th>
              <th>描述</th>
            </tr>
            <tr>
              <td>in</td>
              <td>默认使用的缺省限定符，指明参数传递的是值，并且函数不会修改传入的值（C 语言中值传递）</td>
            </tr>
            <tr>
              <td>const in</td>
              <td>将只读数据拷贝到函数。</td>
            </tr>
            <tr>
              <td>inout</td>
              <td>指明参数传入的是引用，如果在函数中对参数的值进行了修改，当函数结束后参数的值也会修改（C 语言中引用传递）</td>
            </tr>
            <tr>
              <td>out</td>
              <td>参数的值不会传入函数，但是在函数内部修改其值，函数结束后其值会被修改</td>
            </tr>
          </table>
        </section>
      </section>
      <section id="variable" class="section1">
        <h4 class="title">着色器中的变量</h4>
        <section>
          <h4>变量概述</h4>
          <p>声明在函数外部的是全局变量，声明在函数内部的是局部变量。</p>
          <div class="content">
            <strong>规范</strong>
            <ul class="ul-1">
              <li>只包含a-z\A-Z和下划线_</li>
              <li>首字母大写</li>
              <li>不能使用保留字</li>
            </ul>
          </div>
        </section>
        <section id="fragmentBuiltVariable">
          <h4>片元着色器中的内置变量</h4>
          <div class="content">
            <table border="1">
              <tr>
                <th colspan="3">片元着色器中的内置变量</th>
              </tr>
              <tr>
                <th>类型和变量名</th>
                <th>描述</th>
                <th>实例</th>
              </tr>
              <tr>
                <td>vec4 gl_FragColor</td>
                <td>指定片元颜色（RGBA格式）</td>
                <td></td>
              </tr>
              <tr>
                <td>vec4 gl_FragCoord</td>
                <td>片元的窗口坐标，第1个x和第2个y分量表示在canvas坐标系统中（窗口坐标系统）的坐标值。z值是深度值。</td>
                <td></td>
              </tr>
              <tr>
                <td>vec4 gl_PointCoord</td>
                <td>片元在被绘制的点内的坐标（0.0到1.0）</td>
                <td>
                  <ul class="ul-1-num">
                    <li><a href="../../../WebGL编程指南/ch10/RoundedPoints.html" target="_blank">实现画圆</a></li>
                  </ul>
                </td>
              </tr>
            </table>
          </div>
        </section>
        <section id="vertexBuiltVariable">
          <h4>顶点着色器中的内置变量</h4>
          <div class="content">
            <table border="1px">
              <tr>
                <th colspan="2">顶点着色器的内置变量</th>
              </tr>
              <tr>
                <th>类型和变量名</th>
                <th>描述</th>
              </tr>
              <tr>
                <td>vec4 gl_Position</td>
                <td>
                  表示顶点的位置，注意变量必须被赋值，否则着色器就无法正常工作
                </td>
              </tr>
              <tr>
                <td>float gl_PointSize</td>
                <td>
                  表示点的尺寸(像素数)，
                  不是必须的，不过不赋值，着色器会取默认值1.0
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>
      <section id="dataType" class="section1">
        <h4 class="title">GLSE中的数据类型</h4>
        <section id="numberType">
          <h4>数据值类型</h4>
          <div class="content">
            <table border="1" style="border-collapse: collapse">
              <tr>
                <th>类型</th>
                <th>描述</th>
              </tr>
              <tr>
                <td>数值类型</td>
                <td>支持整数和浮点数</td>
              </tr>
              <tr>
                <td>布尔值类型</td>
                <td>true\false</td>
              </tr>
            </table>
            <p>不支持字符串类型</p>
          </div>
        </section>
        <section id="texture">
          <h4>专用于纹理的数据类型</h4>
          <div class="content">
            <table border="1">
              <tr>
                <th colspan="2">专用于纹理的数据类型</th>
              </tr>
              <tr>
                <th>类型</th>
                <th>描述</th>
              </tr>
              <tr>
                <td>sampler2D</td>
                <td>绑定到gl.TEXTURE_2D上的纹理数据类型</td>
              </tr>
              <tr>
                <td>samplerCube</td>
                <td>绑定到gl.TEXTURE_CUBE_MAP上的纹理数据类型</td>
              </tr>
            </table>
          </div>
        </section>
      </section>
    </div>
  </div>
</div>
</body>
</html>