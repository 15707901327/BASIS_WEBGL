<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>一簇水晶</title>
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../../css/base.css">
  <script type="module">
    import WebGLRenderer from "../src/render/WebGLRenderer.js";
    import {VERTEX_SHADER, FRAGMENT_SHADER} from "./shader/shader.js";
    import BufferGeometry from "../src/core/BufferGeometry.js";
    import PerspectiveCamera from "../src/camera/PerspectiveCamera.js";
    import {Float32BufferAttribute,Uint8BufferAttribute} from "../src/core/BufferAttribute.js";

    window.onload = function() {

      // 获取上下文
      let canvas = document.getElementById("webgl");
      let webGLRenderer = new WebGLRenderer({
        canvas: canvas,
        antialias: true
      });

      let perspectiveCamera = new PerspectiveCamera(45, canvas.width / canvas.height, 1, 10000);
      perspectiveCamera.position.set(3, 3, 7);
      perspectiveCamera.lookAt(0, 0, 0);

      // 几何体
      var vertices = [
        // 顶点和颜色坐标
        1.0, 1.0, 1.0,
        -1.0, 1.0, 1.0,
        -1.0, -1.0, 1.0,
        1.0, -1.0, 1.0,
        1.0, -1.0, -1.0,
        1.0, 1.0, -1.0,
        -1.0, 1.0, -1.0,
        -1.0, -1.0, -1.0,
      ];
      var color = [
        // 顶点和颜色坐标
        1.0, 1.0, 1.0,  // v0 White
        1.0, 0.0, 1.0,  // v1 Magenta
        1.0, 0.0, 0.0,  // v2 Red
        1.0, 1.0, 0.0,  // v3 Yellow
        0.0, 1.0, 0.0,  // v4 Green
        0.0, 1.0, 1.0,  // v5 Cyan
        0.0, 0.0, 1.0,  // v6 Blue
        0.0, 0.0, 0.0   // v7 Black
      ];
      var indexes = new Uint8Array([
        0, 1, 2, 0, 2, 3,    // front
        0, 3, 4, 0, 4, 5,    // right
        0, 5, 6, 0, 6, 1,    // up
        1, 6, 7, 1, 7, 2,    // left
        7, 4, 3, 7, 3, 2,    // down
        4, 7, 6, 4, 6, 5     // back
      ]);
      var bufferGeometry = new BufferGeometry();
      bufferGeometry.setAttribute("vertices", new Float32BufferAttribute(vertices, 3));
      bufferGeometry.setAttribute("indexes", new Uint8BufferAttribute(indexes, 3));
      bufferGeometry.setAttribute("color", new Float32BufferAttribute(color, 3));

      var material = {
        vertex: VERTEX_SHADER,
        fragment: FRAGMENT_SHADER
      };

      var mesh = {
        geometry: bufferGeometry,
        material: material
      };

      webGLRenderer.render(mesh, perspectiveCamera);
    }
  </script>
</head>
<body>
<div id="container">
  <canvas id="webgl" height="400" width="400"></canvas>
</div>

</body>
</html>